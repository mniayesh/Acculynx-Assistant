# Generated via scripts/generate.js. Do not edit this file directly; update scripts or data instead.
openapi: 3.1.0
info:
  title: Accu Gateway
  version: 1.2.4
  description: |
    Gateway for AccuLynx API operations plus helper ops:
      - getR2UploadUrl
      - getR2DownloadUrl
      - dryRun mode
      - /gateway/meta discovery
servers:
  - url: https://accu-gateway.mniayesh.workers.dev
paths:
  /gateway:
    post:
      operationId: dispatch
      summary: Dispatch an AccuLynx operation by name
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GatewayDispatchRequest'
      responses:
        '200':
          description: Upstream response passthrough (JSON or text)
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
            text/plain:
              schema:
                type: string
        '400':
          description: Unknown operation or bad request
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
        '401':
          description: Unauthorized (if enforced by deployment)
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
        '404':
          description: Not found (wrong path/method)
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
  /gateway/meta:
    get:
      operationId: getMeta
      summary: List supported operations and settings
      responses:
        '200':
          description: Metadata response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GatewayMetaResponse'
              examples:
                meta:
                  summary: Example metadata
                  value:
                    operations:
__META_EXAMPLE_OPERATIONS__
                    settings:
                      timeoutDefaultMs: 30000
                      uploadModes:
                        - base64
                        - fileUrl
                        - r2
        '401':
          description: Unauthorized (missing/invalid gateway bearer)
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
components:
  schemas:
    GatewayDispatchRequest:
      type: object
      required:
        - operation
      properties:
        operation:
          $ref: '#/components/schemas/GatewayOperation'
        actorUserId:
          type: string
          description: Optional per-user token routing key.
        params:
          $ref: '#/components/schemas/GatewayDispatchParams'
        timeoutMs:
          type: integer
          default: 30000
          description: Upstream request timeout in milliseconds.
    GatewayDispatchParams:
      type: object
      properties:
        path:
          type: object
          additionalProperties: true
        query:
          type: object
          additionalProperties: true
        body:
          type: object
          additionalProperties: true
        contentType:
          type: string
          enum:
            - application/json
            - multipart/form-data
            - application/x-www-form-urlencoded
          default: application/json
    GatewayMetaResponse:
      type: object
      properties:
        operations:
          type: array
          items:
            $ref: '#/components/schemas/GatewayOperation'
        settings:
          type: object
          additionalProperties: true
    GatewayOperation:
      type: string
      description: AccuLynx operation name accepted by the gateway dispatcher.
      enum:
__OPERATIONS_ENUM__
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
x-acculynx-operations:
__OPERATIONS_TABLE__
security:
  - bearerAuth: []
